<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üé± PoolMind ‚Äî Real-time Pool Vision System</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üé±</text></svg>">

    <!-- Tailwind CSS CDN with JIT -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Custom Tailwind Config -->
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        'pool-green': '#0d5a0d',
                        'pool-felt': '#1a5f1a',
                        'cue-white': '#f8fafc',
                        'solid-green': '#16a34a',
                        'stripe-blue': '#2563eb',
                        'eight-black': '#1f2937'
                    },
                    animation: {
                        'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'bounce-subtle': 'bounce 2s infinite',
                        'fade-in': 'fadeIn 0.5s ease-in-out',
                        'slide-in': 'slideIn 0.3s ease-out'
                    },
                    keyframes: {
                        fadeIn: {
                            '0%': { opacity: '0', transform: 'translateY(10px)' },
                            '100%': { opacity: '1', transform: 'translateY(0)' }
                        },
                        slideIn: {
                            '0%': { transform: 'translateX(-10px)', opacity: '0' },
                            '100%': { transform: 'translateX(0)', opacity: '1' }
                        }
                    }
                }
            }
        }
    </script>

    <!-- Custom styles -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');

        body {
            font-family: 'Inter', system-ui, -apple-system, sans-serif;
        }

        .glass-effect {
            backdrop-filter: blur(12px);
            background: rgba(255, 255, 255, 0.1);
        }

        .dark .glass-effect {
            background: rgba(0, 0, 0, 0.3);
        }

        .video-container {
            position: relative;
            overflow: hidden;
        }

        .video-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, transparent 49%, rgba(255,255,255,0.03) 50%, transparent 51%);
            pointer-events: none;
            z-index: 1;
        }

        .status-dot-online {
            background: linear-gradient(45deg, #10b981, #34d399);
            box-shadow: 0 0 10px rgba(16, 185, 129, 0.5);
        }

        .status-dot-offline {
            background: linear-gradient(45deg, #ef4444, #f87171);
            box-shadow: 0 0 10px rgba(239, 68, 68, 0.5);
        }

        .metric-card {
            background: linear-gradient(135deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.1);
        }

        .dark .metric-card {
            background: linear-gradient(135deg, rgba(0,0,0,0.3) 0%, rgba(0,0,0,0.1) 100%);
            border: 1px solid rgba(255,255,255,0.1);
        }
    </style>
</head>

<body class="bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 dark:from-black dark:via-gray-900 dark:to-black text-white min-h-screen transition-all duration-300">

    <!-- Header -->
    <header class="sticky top-0 z-50 glass-effect border-b border-white/10">
        <div class="container mx-auto px-4 py-4">
            <div class="flex items-center justify-between">
                <!-- Logo & Title -->
                <div class="flex items-center space-x-3">
                    <div class="text-3xl animate-bounce-subtle">üé±</div>
                    <div>
                        <h1 class="text-xl font-bold bg-gradient-to-r from-green-400 to-blue-500 bg-clip-text text-transparent">
                            PoolMind
                        </h1>
                        <p class="text-xs text-gray-400">Real-time Vision System</p>
                    </div>
                </div>

                <!-- Status & Controls -->
                <div class="flex items-center space-x-4">
                    <!-- Dark Mode Toggle -->
                    <button id="theme-toggle" class="p-2 rounded-lg glass-effect hover:bg-white/10 transition-all duration-200">
                        <svg id="theme-toggle-dark-icon" class="hidden w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path>
                        </svg>
                        <svg id="theme-toggle-light-icon" class="hidden w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" clip-rule="evenodd"></path>
                        </svg>
                    </button>

                    <!-- Connection Status -->
                    <div class="flex items-center space-x-2">
                        <div id="status-indicator" class="w-3 h-3 rounded-full status-dot-online animate-pulse-slow"></div>
                        <span id="status-text" class="text-sm font-medium text-green-400">Connected</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-6 space-y-6">

        <!-- Live Stream Section -->
        <section class="animate-fade-in">
            <div class="grid lg:grid-cols-3 gap-6">
                <!-- Live Video Feed -->
                <div class="lg:col-span-2">
                    <div class="metric-card rounded-2xl p-6">
                        <div class="flex items-center justify-between mb-4">
                            <h2 class="text-lg font-semibold flex items-center space-x-2">
                                <span class="text-red-500">üî¥</span>
                                <span>Live Feed</span>
                            </h2>
                            <div class="flex space-x-2">
                                <button id="fullscreen-btn" class="px-3 py-1 text-xs bg-white/10 hover:bg-white/20 rounded-lg transition-all duration-200">
                                    üì∫ Fullscreen
                                </button>
                                <a href="/frame.jpg" target="_blank" class="px-3 py-1 text-xs bg-blue-500/20 hover:bg-blue-500/30 rounded-lg transition-all duration-200">
                                    üì∏ Snapshot
                                </a>
                            </div>
                        </div>

                        <div class="video-container rounded-xl overflow-hidden bg-gray-800/50 aspect-video">
                            <img
                                id="live-stream"
                                src="/stream.mjpg"
                                alt="Live Pool Table Feed"
                                class="w-full h-full object-cover"
                                onerror="handleStreamError()"
                            />

                            <!-- Stream Overlay -->
                            <div class="absolute top-4 right-4 glass-effect px-3 py-1 rounded-lg text-xs font-medium">
                                <span id="stream-status">MJPEG ‚Ä¢ Live</span>
                            </div>

                            <!-- FPS Counter -->
                            <div class="absolute bottom-4 left-4 glass-effect px-3 py-1 rounded-lg text-xs">
                                FPS: <span id="fps-counter" class="font-mono text-green-400">--</span>
                            </div>
                        </div>

                        <div class="mt-4 flex flex-wrap gap-2">
                            <a href="/markers/download" class="inline-flex items-center space-x-1 px-3 py-2 bg-green-500/20 hover:bg-green-500/30 rounded-lg text-sm transition-all duration-200">
                                <span>üéØ</span>
                                <span>Download ArUco Markers</span>
                            </a>
                            <button onclick="resetGame()" class="inline-flex items-center space-x-1 px-3 py-2 bg-orange-500/20 hover:bg-orange-500/30 rounded-lg text-sm transition-all duration-200">
                                <span>üîÑ</span>
                                <span>Reset Game</span>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Game Status Panel -->
                <div class="space-y-6">
                    <!-- Current Game State -->
                    <div class="metric-card rounded-2xl p-6">
                        <h3 class="text-lg font-semibold mb-4 flex items-center space-x-2">
                            <span>üéÆ</span>
                            <span>Game Status</span>
                        </h3>
                        <div id="game-status" class="space-y-3">
                            <!-- Dynamic content -->
                        </div>
                    </div>

                    <!-- Quick Actions -->
                    <div class="metric-card rounded-2xl p-6">
                        <h3 class="text-lg font-semibold mb-4 flex items-center space-x-2">
                            <span>‚ö°</span>
                            <span>Quick Actions</span>
                        </h3>
                        <div class="space-y-3">
                            <button class="w-full px-4 py-2 bg-blue-500/20 hover:bg-blue-500/30 rounded-lg text-sm transition-all duration-200 flex items-center justify-center space-x-2">
                                <span>üìä</span>
                                <span>View Analytics</span>
                            </button>
                            <button class="w-full px-4 py-2 bg-purple-500/20 hover:bg-purple-500/30 rounded-lg text-sm transition-all duration-200 flex items-center justify-center space-x-2">
                                <span>‚öôÔ∏è</span>
                                <span>Settings</span>
                            </button>
                            <button class="w-full px-4 py-2 bg-gray-500/20 hover:bg-gray-500/30 rounded-lg text-sm transition-all duration-200 flex items-center justify-center space-x-2">
                                <span>üì±</span>
                                <span>Share View</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Ball Tracking Stats -->
        <section class="animate-fade-in">
            <div class="grid md:grid-cols-2 xl:grid-cols-4 gap-6">
                <!-- Active Balls -->
                <div class="metric-card rounded-2xl p-6">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm text-gray-400 mb-1">Active Balls</p>
                            <p id="active-balls-count" class="text-2xl font-bold text-white">--</p>
                        </div>
                        <div class="text-3xl opacity-60">üé±</div>
                    </div>
                    <div class="mt-4 h-2 bg-gray-700 rounded-full overflow-hidden">
                        <div id="active-balls-progress" class="h-full bg-gradient-to-r from-green-500 to-blue-500 transition-all duration-500" style="width: 0%"></div>
                    </div>
                </div>

                <!-- Cue Ball -->
                <div class="metric-card rounded-2xl p-6">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm text-gray-400 mb-1">Cue Ball</p>
                            <p id="cue-ball-count" class="text-2xl font-bold text-cue-white">--</p>
                        </div>
                        <div class="w-8 h-8 bg-white rounded-full border-2 border-gray-300"></div>
                    </div>
                    <p id="cue-ball-status" class="text-xs text-gray-400 mt-2">Tracking status</p>
                </div>

                <!-- Solid Balls -->
                <div class="metric-card rounded-2xl p-6">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm text-gray-400 mb-1">Solid Balls</p>
                            <p id="solid-balls-count" class="text-2xl font-bold text-solid-green">--</p>
                        </div>
                        <div class="w-8 h-8 bg-solid-green rounded-full"></div>
                    </div>
                    <p id="solid-balls-potted" class="text-xs text-gray-400 mt-2">Potted: --</p>
                </div>

                <!-- Stripe Balls -->
                <div class="metric-card rounded-2xl p-6">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm text-gray-400 mb-1">Stripe Balls</p>
                            <p id="stripe-balls-count" class="text-2xl font-bold text-stripe-blue">--</p>
                        </div>
                        <div class="w-8 h-8 bg-stripe-blue rounded-full"></div>
                    </div>
                    <p id="stripe-balls-potted" class="text-xs text-gray-400 mt-2">Potted: --</p>
                </div>
            </div>
        </section>

        <!-- Game Events & Analytics -->
        <section class="animate-fade-in">
            <div class="grid lg:grid-cols-2 gap-6">
                <!-- Recent Events -->
                <div class="metric-card rounded-2xl p-6">
                    <h3 class="text-lg font-semibold mb-4 flex items-center space-x-2">
                        <span>üìù</span>
                        <span>Recent Events</span>
                    </h3>
                    <div id="events-container" class="space-y-2 max-h-64 overflow-y-auto">
                        <!-- Dynamic content -->
                    </div>
                </div>

                <!-- Game Analytics -->
                <div class="metric-card rounded-2xl p-6">
                    <h3 class="text-lg font-semibold mb-4 flex items-center space-x-2">
                        <span>üìä</span>
                        <span>Session Analytics</span>
                    </h3>
                    <div id="analytics-container" class="space-y-4">
                        <!-- Dynamic content -->
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="border-t border-white/10 mt-12">
        <div class="container mx-auto px-4 py-6">
            <div class="flex flex-col md:flex-row justify-between items-center space-y-4 md:space-y-0">
                <div class="text-sm text-gray-400">
                    üöÄ Powered by <span class="text-green-400">FastAPI</span> + <span class="text-blue-400">OpenCV</span> + <span class="text-purple-400">ArUco</span>
                </div>
                <div class="text-sm text-gray-400">
                    Updates every <span id="refresh-interval" class="font-mono text-green-400">1000ms</span>
                </div>
            </div>
        </div>
    </footer>

    <!-- JavaScript -->
    <script src="/static/app.js"></script>
</body>
</html>
